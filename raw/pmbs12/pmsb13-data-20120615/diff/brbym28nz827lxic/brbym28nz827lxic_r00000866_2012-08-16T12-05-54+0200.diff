diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp ./sandbox/meyerclp/apps/dreme/dreme.cpp
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp	2012-08-09 21:08:08.846598800 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.cpp	2012-08-16 12:05:37.753506100 +0200
@@ -250,10 +250,11 @@
 		++background.c;
 	}
 	while(sequences.pValue<0.05 && sequences.c<5);
-
-	computeGap(sequences.allPWMs);
 	String<Cluster> cluster;
 	PWMClustering(sequences.allPWMs,cluster);
+
+	computeGap(sequences.allPWMs);
+	
 	clear(cluster);
 	/***
 		MOTIF 1 CONSENSUS: TGAAAG
diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h ./sandbox/meyerclp/apps/dreme/dreme.h
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h	2012-08-09 21:35:11.340598800 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.h	2012-08-16 12:05:37.768506100 +0200
@@ -158,6 +158,8 @@
 double computeDr(Cluster &cluster,std::vector<std::vector<String<double> > > copyCompare);
 double computeWk(int n,String<Cluster> &cluster);
 void computeReferenceData(String< std::map<unsigned int,std::map<Iupac,double> > > &Reference,unsigned allPWMsLength,unsigned PWMLength );
+void computeGap(String< std::map<unsigned int,std::map<Iupac,double> > > &allPWMs, String<Cluster> &observedCluster);
+
 
 void readFastA( struct Seq &seq, 
 				CharString fname){
@@ -1060,7 +1062,7 @@
 	
 
 	for(unsigned i=0;i<allPWMsLength;++i){//genauso viele Reference-Daten erstellen, wie PWMs vorhanden
-		std::cout<<"i "<<i<<std::endl;
+		//std::cout<<"i "<<i<<std::endl;
 		for(unsigned j=0;j<PWMLength;++j){
 			ACGT="ACGT";
 			uniDouble=0;
@@ -1100,10 +1102,12 @@
 //
 //}
 //
-void computeGap(String< std::map<unsigned int,std::map<Iupac,double> > > &allPWMs){
+void computeGap(String< std::map<unsigned int,std::map<Iupac,double> > > &allPWMs, String<Cluster> &observedCluster){
 
 	String<Cluster> cluster;
 	String<String<double> > allWk;
+	String<double> Gap;
+	String<double> l_quer_for_k;
 	double l_quer;
 	String<double> sdk;//Standard-Abweichungen
 	String<double> sk;
@@ -1117,7 +1121,8 @@
 	resize(allWk,B);
 	resize(sdk,allPWMsLength);
 	resize(sk,allPWMsLength);
-	
+	resize(Gap,allPWMsLength);
+	resize(l_quer_for_k,allPWMsLength);
 	/************
 		l_quer berechnen
 	************/
@@ -1132,10 +1137,14 @@
 			
 			appendValue(allWk[i],cluster[k].Wk);
 			
-			if(i==0)
+			if(i==0){
+				l_quer_for_k[k]=log(cluster[k].Wk)/B;
 				l_quer=log(cluster[k].Wk)/B;
-			else
+			}
+			else{
 				l_quer+=log(cluster[k].Wk)/B;
+				l_quer_for_k[k]+=log(cluster[k].Wk)/B;
+			}
 		}
 
 		clear(Reference);
@@ -1143,6 +1152,14 @@
 
 	}
 	
+	/******************
+		Gap berechnen
+	******************/
+	for(unsigned k=0;k<allPWMsLength;++k){
+
+		appendValue(Gap,l_quer_for_k[k]-log(observedCluster[k].Wk));
+	}
+
 
 	/******************
 		sdk berechnen
