diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h ./sandbox/meyerclp/apps/dreme/dreme.h
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h	2012-08-05 17:37:10.730803900 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.h	2012-08-06 12:18:48.912010700 +0200
@@ -74,6 +74,7 @@
 	unsigned right;
 	String<int>  content;
 	double Dr;
+	double Wk;
 
 
 };
@@ -154,7 +155,7 @@
 void computesDistantMatrix(Seq &seq,std::vector<std::vector<String<double > > > &compare, unsigned allPWMsLength);
 String<double> AlignPWMs(std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2);
 double computeDr(Cluster &cluster,std::vector<std::vector<String<double> > > copyCompare);
-
+double computeWk(int n,String<Cluster> &cluster);
 
 
 void readFastA( struct Seq &seq, 
@@ -989,11 +990,46 @@
 	return Dr;
 }
 
+double computeWk(int n,String<Cluster> &cluster){// n=allPWMsLength-n
+
+	/***
+
+		Wenn ein neues Cluster hinzukommt einfach addieren/n
+		Wenn ein bestehendes ver채ndert wird, den wert austauschen
+		--> anhand von left/right machbar --> falls dort negative zahlen, dann ver채ndert 
+			falls nicht addieren 
+			falls negativ --> -negativ -1 bestimmt cluster-nummer, dort Dr wert
+
+
+	***/
+
+
+	if(n>0)
+		cluster[n].Wk=cluster[n-1].Wk;
+	else
+		cluster[n].Wk=0;
+
+	if(cluster[n].left>=0 && cluster[n].right>=0)
+		cluster[n].Wk +=cluster[n].Dr/length(cluster[n].content);//braucht nicht durch 2 dividieren, da in content nur die eine h채lfte aufaddiert wurde
+	else{
+		if(cluster[n].left<0)
+			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].left-1].Wk;//das Wk des vorherigen clusters abziehen --> 12 wird mit 3 zu 123 geklustert-->w채re 123.Dr/1 --> 12 wird von 12 und 3 abgezogen und 123 am ende der else addiert
+		if(cluster[n].right<0)
+			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].right-1].Wk;	
+
+		cluster[n].Wk= cluster[n].Wk+ cluster[n].Dr/length(cluster[n].content);
+	}
+
+	return cluster[n].Wk;
+
+
+}
+
 
 
 void PWMClustering(Seq &seq){
 	unsigned allPWMsLength=length(seq.allPWMs);
-
+	
 	String<Cluster> cluster;
 	resize(cluster,allPWMsLength);
 	
@@ -1078,8 +1114,11 @@
 		/****
 					Dr berechnet
 		****/
+		cluster[allPWMsLength-n].left=clusterId[int(minDifference[1])];
+		cluster[allPWMsLength-n].right=clusterId[int(minDifference[2])];
 		cluster[allPWMsLength-n].Dr=computeDr(cluster[allPWMsLength-n],copyCompare);
-
+		computeWk(allPWMsLength-n,cluster);
+		
 
 
 		/*std::cout<<"Cluster: ";
@@ -1088,8 +1127,7 @@
 		}
 		std::cout<<std::endl;*/
 
-		cluster[allPWMsLength-n].left=clusterId[int(minDifference[1])];
-		cluster[allPWMsLength-n].right=clusterId[int(minDifference[2])];
+		
 
 		appendValue(traceback,clusterId[int(minDifference[1])]);
 		appendValue(traceback,clusterId[int(minDifference[2])]);
