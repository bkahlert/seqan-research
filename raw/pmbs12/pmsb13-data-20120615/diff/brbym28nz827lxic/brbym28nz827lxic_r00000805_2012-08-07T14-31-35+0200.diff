diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h ./sandbox/meyerclp/apps/dreme/dreme.h
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h	2012-08-07 14:20:56.391798500 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.h	2012-08-07 14:31:33.876798500 +0200
@@ -1013,9 +1013,9 @@
 		cluster[n].Wk +=cluster[n].Dr/length(cluster[n].content);//braucht nicht durch 2 dividieren, da in content nur die eine hälfte aufaddiert wurde
 	else{
 		if(cluster[n].left<0)
-			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].left-1].Wk;//das Wk des vorherigen clusters abziehen --> 12 wird mit 3 zu 123 geklustert-->wäre 123.Dr/1 --> 12 wird von 12 und 3 abgezogen und 123 am ende der else addiert
+			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].left-1].Dr/length(cluster[-cluster[n].left-1].content);//das Wk des vorherigen clusters abziehen --> 12 wird mit 3 zu 123 geklustert-->wäre 123.Dr/1 --> 12 wird von 12 und 3 abgezogen und 123 am ende der else addiert
 		if(cluster[n].right<0)
-			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].right-1].Wk;	
+			cluster[n].Wk=cluster[n-1].Wk - cluster[-cluster[n].right-1].Dr/length(cluster[-cluster[n].right-1].content);	
 
 		cluster[n].Wk= cluster[n].Wk + cluster[n].Dr/length(cluster[n].content);
 	}
diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme_test.cpp ./sandbox/meyerclp/apps/dreme/dreme_test.cpp
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme_test.cpp	2012-08-07 14:25:04.533798500 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme_test.cpp	2012-08-07 14:31:33.773798500 +0200
@@ -1007,7 +1007,7 @@
 	using namespace seqan;
 
 	String<Cluster> cluster;
-	resize(cluster,5);
+	resize(cluster,7);
 	int n=0;
 	String<int> temp;
 
@@ -1021,6 +1021,7 @@
 	
 	SEQAN_ASSERT_EQ(computeWk(n,cluster),1.495);
 	SEQAN_ASSERT_EQ(cluster[n].Wk,1.495);
+
 	++n;
 	cluster[n].left=-1;
 	cluster[n].right=3;
@@ -1031,6 +1032,32 @@
 	cluster[n].Dr=3.33;
 	SEQAN_ASSERT_EQ(computeWk(n,cluster),1.11);
 	SEQAN_ASSERT_EQ(cluster[n].Wk,1.11);
+	clear(temp);
+
+	++n;
+	cluster[n].left=4;
+	cluster[n].right=5;
+	appendValue(temp,5);
+	appendValue(temp,4);
+	cluster[n].content=temp;
+	cluster[n].Dr=2.5;
+	SEQAN_ASSERT_EQ(computeWk(n,cluster),2.36);
+	SEQAN_ASSERT_EQ(cluster[n].Wk,2.36);
+	clear(temp);
+
+	++n;
+	cluster[n].left=-2;
+	cluster[n].right=-3;
+	appendValue(temp,1);
+	appendValue(temp,2);
+	appendValue(temp,3);
+	appendValue(temp,5);
+	appendValue(temp,4);
+	cluster[n].content=temp;
+	cluster[n].Dr=4.5;
+	SEQAN_ASSERT_EQ(computeWk(n,cluster),0.9);
+	SEQAN_ASSERT_EQ(cluster[n].Wk,0.9);
+	clear(temp);
 
 }
 
