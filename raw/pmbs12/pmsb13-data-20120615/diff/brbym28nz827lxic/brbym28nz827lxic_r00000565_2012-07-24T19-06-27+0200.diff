diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp ./sandbox/meyerclp/apps/dreme/dreme.cpp
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp	2012-07-24 16:04:36.254010200 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.cpp	2012-07-24 19:06:13.017010200 +0200
@@ -228,7 +228,7 @@
 		//clear(sequences.SArray);
 		//clear(background.SArray);
 		//std::cout<<sequences.generalizedSortedPValue.begin()->first<<std::endl;
-		std::cout<<"vor if"<<std::endl;
+		//std::cout<<"vor if"<<std::endl;
 		if(sequences.c==1){//nur im ersten Schritt creatIntervalTree danach addInterval
 
 			for(unsigned s=0;s<sequences.SeqsNumber;++s){
@@ -238,7 +238,7 @@
 				createIntervalTree(background.intervalTrees[b], background.intervals[b]);
 			}
 		}
-		std::cout<<"nach if"<<std::endl;
+		//std::cout<<"nach if"<<std::endl;
 		clear(sequences.intervals);
 		clear(background.intervals);
 
diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h ./sandbox/meyerclp/apps/dreme/dreme.h
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h	2012-07-24 16:04:36.298010200 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.h	2012-07-24 19:06:13.109010200 +0200
@@ -66,6 +66,22 @@
 };
 
 
+
+struct Euklidisch_;
+typedef Tag<Euklidisch_> Euklidisch;
+
+struct Pearson_;
+typedef Tag<Pearson_> Pearson;
+
+struct Mahalanobis_;
+typedef Tag<Mahalanobis_> Mahalanobis;
+
+struct Entropy_;
+typedef Tag<Entropy_> Entropy;
+
+
+
+
 void readFastA(struct Seq &seq, CharString fname);
 template <typename TStream>
 void PrintFastA(TStream & stream, Seq &seq);
@@ -109,7 +125,9 @@
 void BuildFrequencyMatrix( Finder<Index<StringSet<String<Dna5> > > > &finder,String<Dna5> &Kmer,Seq &seq, IupacMaps &IMaps);
 void BuildWeightMatrix(Seq &seq);
 void BuildInformationContentMatrix(Seq &seq);
-void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2);
+void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2, Entropy const & tag);
+void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2, Euklidisch const & tag);
+
 void replaceKmer(Seq &seq,unsigned int stringNumber, unsigned int begin, unsigned int end);
 
 
@@ -717,7 +735,7 @@
 
 }
 
-void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2){
+void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2, Entropy const & tag){
 
 	/***
 	Matrizen müssen nicht gleich lang sein --> vorher mit fester Größe noch einmal die kMere scannen?
@@ -732,13 +750,38 @@
 
 			Für jede Spalte berechnen und durch Spaltenanzahl teilen
 	****/
-	for(unsigned int j=0;j<length(freqMatrix1);++j){
-		seq.columnEntropy[j] = freqMatrix1[j]['A']*log(freqMatrix1[j]['A']/freqMatrix2[j]['A']);
-		seq.columnEntropy[j] = freqMatrix1[j]['C']*log(freqMatrix1[j]['C']/freqMatrix2[j]['C']);
-		seq.columnEntropy[j] = freqMatrix1[j]['G']*log(freqMatrix1[j]['G']/freqMatrix2[j]['G']);
-		seq.columnEntropy[j] = freqMatrix1[j]['T']*log(freqMatrix1[j]['T']/freqMatrix2[j]['T']);
-	}
+	seq.columnEntropy[0]=0;
 	
+	for(unsigned int j=1;j<length(freqMatrix1)+1;++j){
+		seq.columnEntropy[j]  = freqMatrix1[j-1]['A']*log(freqMatrix1[j-1]['A']/freqMatrix2[j-1]['A']);
+		seq.columnEntropy[j] += freqMatrix1[j-1]['C']*log(freqMatrix1[j-1]['C']/freqMatrix2[j-1]['C']);
+		seq.columnEntropy[j] += freqMatrix1[j-1]['G']*log(freqMatrix1[j-1]['G']/freqMatrix2[j-1]['G']);
+		seq.columnEntropy[j] += freqMatrix1[j-1]['T']*log(freqMatrix1[j-1]['T']/freqMatrix2[j-1]['T']);
+		seq.columnEntropy[j] += freqMatrix2[j-1]['A']*log(freqMatrix2[j-1]['A']/freqMatrix1[j-1]['A']);
+		seq.columnEntropy[j] += freqMatrix2[j-1]['C']*log(freqMatrix2[j-1]['C']/freqMatrix1[j-1]['C']);
+		seq.columnEntropy[j] += freqMatrix2[j-1]['G']*log(freqMatrix2[j-1]['G']/freqMatrix1[j-1]['G']);
+		seq.columnEntropy[j] += freqMatrix2[j-1]['T']*log(freqMatrix2[j-1]['T']/freqMatrix1[j-1]['T']);
+		seq.columnEntropy[j]  = seq.columnEntropy[j]/2;
+		seq.columnEntropy[0] += seq.columnEntropy[j]; 
+
+	}
+	seq.columnEntropy[0]=seq.columnEntropy[0]/length(freqMatrix1);
+
+}
+
+void ComparePWM(Seq &seq,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix1,std::map<unsigned int,std::map<Iupac,double> > &freqMatrix2, Euklidisch const & tag){
+
+	seq.columnEntropy[0]=0;
+	for(unsigned int j=1;j<length(freqMatrix1)+1;++j){
+
+		seq.columnEntropy[j]  = (freqMatrix1[j-1]['A'] - freqMatrix2[j-1]['A'])*(freqMatrix1[j-1]['A'] - freqMatrix2[j-1]['A']);
+		seq.columnEntropy[j] += (freqMatrix1[j-1]['C'] - freqMatrix2[j-1]['C'])*(freqMatrix1[j-1]['C'] - freqMatrix2[j-1]['C']);
+		seq.columnEntropy[j] += (freqMatrix1[j-1]['G'] - freqMatrix2[j-1]['G'])*(freqMatrix1[j-1]['G'] - freqMatrix2[j-1]['G']);
+		seq.columnEntropy[j] += (freqMatrix1[j-1]['T'] - freqMatrix2[j-1]['T'])*(freqMatrix1[j-1]['T'] - freqMatrix2[j-1]['T']);
+		seq.columnEntropy[j]  = sqrt(seq.columnEntropy[j]);
+		seq.columnEntropy[0] += seq.columnEntropy[j];
+	}
+	seq.columnEntropy[0]=seq.columnEntropy[0]/length(freqMatrix1);//enthält durchschnitt der spalten
 
 }
 /****
@@ -756,6 +799,33 @@
 
 }
 
+
+void PWMClustering(Seq &seq){
+
+	unsigned allPWMsLength=length(seq.allPWMs); 
+	String<String<double > > compare;
+	String<double> compareTemp;
+
+	for(unsigned int i=0;i<allPWMsLength-1;++i){
+
+		for(unsigned int j=i+1;j<allPWMsLength;++j){
+
+			ComparePWM(seq,seq.allPWMs[i],seq.allPWMs[j],Euklidisch());
+			appendValue(compareTemp,seq.columnEntropy[0]);
+
+		}
+		appendValue(compare,compareTemp);
+		clear(compareTemp);
+
+	}
+
+	std::cout<<compare[0][0]<<" "<<compare[0][1];
+	system("PAUSE");
+
+
+}
+
+
 /*Prints the Mapping:
 Kmer	Seq1	Seq2	...	Seqn	CumulatedCounter
 -->Template
