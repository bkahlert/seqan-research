diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp ./sandbox/meyerclp/apps/dreme/dreme.cpp
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.cpp	2012-09-27 11:48:31.255117500 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.cpp	2012-09-27 12:03:40.187117500 +0200
@@ -77,20 +77,28 @@
 		sequences.NumberOfMotifs=6;
 		
 	}
-	
+	bool save=false;
 	while(true){
-		std::cout<<"Save the data (PWMs) to a file? (Y) (N)"<<std::endl;
+		std::cout<<"Save the data (PWMs) to a file? (Y) (N)"<<std::endl;//path hardcoded--> ToDo
 		std::cin>>setting;
-		if(setting =='Y' || setting=='N' ||setting =='y' ||setting =='n') break;
+		if(setting =='Y' || setting=='y'){
+			save=true;
+			break;
+		}
+		else if(setting =='N' ||setting =='n') break;
 		std::cout<<"**** ERROR: MUST BE Y OR N ****"<<std::endl;
 	}
-	bool save=false;
-	if(setting=='Y' || setting =='y'){
-		save=true;
-		String<char> pwm;
-		std::cout<<"Enter in the path, where the data should be saved:"<<std::endl;
-		std::cin>>pwm;
-		std::cout<<pwm;
+	bool clusterData=false;
+	while(true){
+		std::cout<<"Should the data be clustered? (Y)(N)"<<std::endl;
+		std::cin>>setting;
+		if(setting =='Y' || setting=='y'){
+			clusterData=true;
+			break;
+		}
+		else if(setting =='N' ||setting =='n') break;
+		std::cout<<"**** ERROR: MUST BE Y OR N ****"<<std::endl;
+
 	}
 	
 
@@ -194,7 +202,7 @@
 			/****
 					saves the PWM to a file
 			****/
-			saveData(sequences,PWM,sequences.c);
+			if(save) saveData(sequences,PWM,sequences.c);
 			
 			sequences.pValue=sequences.generalizedSortedPValue.begin()->first;
 		}
@@ -218,7 +226,7 @@
 			/****
 					saves the PWM to a file
 			****/
-			saveData(sequences,PWM,sequences.c);
+			if(save) saveData(sequences,PWM,sequences.c);
 			
 			sequences.pValue=sequences.SortedPValue.begin()->first;
 
@@ -266,17 +274,23 @@
 		++background.c;
 	}
 	while(sequences.pValue<sequences.treshold && sequences.c<sequences.NumberOfMotifs);
+	
+	
+	
+	
 	/******
 			Compute the Clustering with GapStat
 	******/
-	String<Cluster> cluster;
-	String<int> traceback;
-	PWMClustering(sequences.allPWMs,cluster,traceback);
-	std::cout<<"ComputeGapStat"<<std::endl<<std::endl;
-	clusterTraceback(sequences.allMotifs,traceback,computeGapStat(sequences.allPWMs,cluster));
+	if(clusterData){
+		String<Cluster> cluster;
+		String<int> traceback;
+		PWMClustering(sequences.allPWMs,cluster,traceback);
+		std::cout<<"ComputeGapStat"<<std::endl<<std::endl;
+		clusterTraceback(sequences.allMotifs,traceback,computeGapStat(sequences.allPWMs,cluster));
 	
-	seqan::clear(cluster);
-	seqan::clear(traceback);
+		seqan::clear(cluster);
+		seqan::clear(traceback);
+	}
 	seqan::clear(sequences.allMotifs);
 	seqan::clear(sequences.allPWMs);
 	
diff -u -r -N -x '*.o' -x Thumbs.db -x .DS_Store -x CMakeCache.txt -x misc/seqan_instrumentation/userdata/id.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/id.txt -x misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata/brbym28nz827lxic_stats.txt -x .svn -x bin -x build -x util -x misc -x docs -x docs2 -x extras -x core -x misc/seqan_instrumentation/bin -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/bin -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/last_revision_copy -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/last_revision_copy -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata -x misc/seqan_instrumentation/userdata -x C:/Users/David/Desktop/Seqan/Seqan/misc/seqan_instrumentation/userdata ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h ./sandbox/meyerclp/apps/dreme/dreme.h
--- ./misc/seqan_instrumentation/last_revision_copy/sandbox/meyerclp/apps/dreme/dreme.h	2012-09-27 11:19:28.035117500 +0200
+++ ./sandbox/meyerclp/apps/dreme/dreme.h	2012-09-27 12:03:40.207117500 +0200
@@ -157,6 +157,7 @@
 double ComparePWM(std::map<Iupac,double>  &freqMatrix1,std::map<Iupac,double>  &freqMatrix2, Pearson const & tag);
 void PWMClustering(String< std::map<unsigned int,std::map<Iupac,double> > > &allPWMs, String<Cluster> &cluster,String<int> &traceback);
 void UpdateDistantMatrix(int n, int x, int y, std::vector<std::vector<String<double > > > &compare, CompleteLinkage const & tag);
+void UpdateDistantMatrix(int n, int x, int y, std::vector<std::vector<String<double > > > &compare, SingleLinkage const & tag);
 void UpdateDistantMatrix(int n, int x, int y, std::vector<std::vector<String<double > > > &compare,std::vector<unsigned> &weights, AverageLinkage const & tag);
 void minDifferenceInMatrix(unsigned n,String<double> &minDifference,std::vector<std::vector<String<double > > > compare);
 void replaceKmer(Seq &seq,unsigned int stringNumber, unsigned int begin, unsigned int end);
@@ -958,6 +959,32 @@
 
 
 }
+/****
+			Updates the distance with Single Linkage
+			Replaces PWM x with the new one
+			
+****/
+void UpdateDistantMatrix(	int n,
+							int x, 
+							int y, 
+							std::vector<std::vector<String<double> > > &compare, 
+							SingleLinkage const & tag ){
+
+	
+	unsigned j;
+	for (j = 0; j < x; j++)
+		compare[x][j][0] = std::min(compare[y][j][0],compare[x][j][0]);
+	for (j = x+1; j < y; j++)
+		compare[j][x][0] = std::min(compare[y][j][0],compare[j][x][0]);
+	for (j = y+1; j < n; j++)
+		compare[j][x][0] = std::min(compare[j][y][0],compare[j][x][0]);
+	for (j = 0; j < y; j++) compare[y][j][0] = compare[n-1][j][0];
+	for (j = y+1; j < n-1; j++) compare[j][y][0] = compare[n-1][j][0];
+
+
+
+
+}
 
 
 /****
@@ -1399,7 +1426,7 @@
 		
 		//BuildMeanOf2PWMs(seq,seq.allPWMs[int(minDifference[1])],seq.allPWMs[int(minDifference[2])]);//Computes the mean of the two matrices
 		
-		UpdateDistantMatrix(n,int(minDifference[1]),int(minDifference[2]),compare,weights,AverageLinkage());
+		UpdateDistantMatrix(n,int(minDifference[1]),int(minDifference[2]),compare,weights,AverageLinkage());//hardcoded -->ToDo
 	
 		
 		/****
