table
plot(table$X.GC.Content,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences",ylim=c(0,100))
plot(table$X.GC.Content,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences")
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
legend("topright",legend=c("GC count per read","Teoretical Distribution"),cex=.5,text.col=c("red","blue"))
dat<- data.frame(t=seq(0, 2*pi, by=0.1) )
xhrt <- function(t) 16*sin(t)^3
yhrt <- function(t) 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t)
dat$y=yhrt(dat$t)
dat$x=xhrt(dat$t)
with(dat, plot(x,y, type="l"))
plot(table$X.GC.Content,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences")
legend("topright",legend=c("GC count per read"),cex=.5,text.col=c("red"))
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/readlength.tsv", sep="\t",header=TRUE,skip=1)
plot(table$X.Length,table$Count,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",ylim=c(0,100))
plot(table$X.Length,table$Count,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences")
x <- c(min(table$X.Length)-1,table$X.Length,max(table$X.Length)+1)
y <- c(0,table$Count,0)
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences")
grid(nx = NULL, ny = nx, col = "lightgray", lty = "dotted",
lwd = par("lwd"), equilogs = TRUE)
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(3, lty = 1, lwd = 2))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid())
legend("topright",legend="Sequence Length",cex=.5,text.col="red")
x
y
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(ny=5))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="line"))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="l"))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
plot(x,y,type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(1, at=x,labels=x, col.axis="red", las=2)
plot(x,y,xaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(1, at=x,labels=x, col.axis="red", las=2)
axis(1, at=x,labels=x, col.axis="black", las=1)
plot(x,y,xaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(1, at=x,labels=x, col.axis="black", las=1)
z <- seq(0,max(y),by=max(y)/100)
plot(x,y,xaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(2, at=z,labels=z, col.axis="black", las=1)
z
z <- seq(0,max(y),by=max(y)/1000)
plot(x,y,xaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(2, at=z,labels=z, col.axis="black", las=1)
z
z <- seq(0,max(y),by=max(y)/10)
z
plot(x,y,xaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(2, at=z,labels=z, col.axis="black", las=1)
plot(x,y,xaxt="n",yaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(2, at=z,labels=z, col.axis="black", las=1)
axis(1, at=x,labels=x, col.axis="black", las=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/per_pos_qual.tsv", sep="\t",header=TRUE,skip=1)
x<-boxplot(table$Median~table$X.Base,plot=FALSE)
x$stats[2,]<-table$Lower.Quartile
table
x<-boxplot(table$Median~table$Base,plot=FALSE)
x$stats[2,]<-table$Lower.Quartile
x$stats[1,]<-table$X10th.Percentile
x$stats[3,]<-table$Median
x$stats[5,]<-table$X90th.Percentile
x$stats[4,]<-table$Upper.Quartile
x$names<-table$X.Base
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
ployx<-1:max(table$X.Base)
ployx<-seq(1,max(table$X.Base))
table$X.Base
table
ployx<-seq(1,max(table$Base))
polygon(polyx,20,col="red")
polyx<-seq(1,max(table$Base))
polygon(polyx,20,col="red")
polyy<-rep(20,max(table$Base))
polygon(polyx,polyy,col="red")
rect(0,0,max(table$Base),20,col="red")
rect(0,0,max(table$Base),20,col="ligthcoral")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
rect(0,0,max(table$Base),20,col="lightcoral")
rect(0,20,max(table$Base),28,col="lightgoldenrod")
rect(0,28,max(table$Base),max(table$X90th.Percentile),col="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
#!/usr/bin/env Rscript
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/per_pos_qual.tsv", sep="\t",header=TRUE,skip=1)
x<-boxplot(table$Median~table$Base,plot=FALSE)
x$stats[2,]<-table$Lower.Quartile
x$stats[1,]<-table$X10th.Percentile
x$stats[3,]<-table$Median
x$stats[5,]<-table$X90th.Percentile
x$stats[4,]<-table$Upper.Quartile
x$names<-table$Base
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
rect(0,0,max(table$Base),20,col="lightcoral")
rect(0,20,max(table$Base),28,col="lightgoldenrod")
rect(0,28,max(table$Base),max(table$X90th.Percentile),col="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid()
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border=NULL)
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
lines(table$Mean,lwd=1,col="blue")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base),ny=Null)
grid(nx=max(table$Base),ny=Null,lty=1,col=c(1,2))
grid(nx=max(table$Base),ny=Null,lty=1,fill=c(1,2))
grid(nx=max(table$Base),ny=Null,lty=1)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base),ny=Null,lty=1)
dev.off()
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base),ny=Null,lty=1)
grid(nx=max(table$Base)-5,ny=NULL,lty=1)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base)-5,ny=NULL,lty=1)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base),ny=0,lty=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
table
table [1,]
table [,2]
plot(table$Position,table[,2],type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,100))
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6])
plot(table$Position,table[,2],type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=max(ylimvar)
legend("topright",legend="%N",cex=.5,text.col="red")
plot(table$Position,table[,2],type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=max(ylimvar))
ylimvar
plot(table$Position,table[,2],type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=1,col="blue")
lines(table[,4],lwd=1,col="green")
lines(table[,5],lwd=1,col="black")
lines(table[,6],lwd=1,col="pink")
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="pink")
table[1,1]
table[0,1]
table[1]
table[1,]
colnames(table)
ltv<-colnames(table)
ltv
ltv[1]
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6])
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="yellow")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,cex=.5,text.col=c("red","blue","green","black","yellow","magenta")
)
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"))
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="yellow")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"))
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="yellow")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"))
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"),bg="lightgrey")
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"),bg="gray90")
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"),bg="gray100")
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"),bg="gray95")
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","yellow","magenta"),bg="gray95",horiz=TRUE)
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="orange")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","orange","magenta"),bg="gray95",horiz=TRUE)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/seq_qual.tsv", sep="\t",header=TRUE,skip=1)
plot(table$Quality,table$Count,type="l",col="red",xlab="Mean Sequence Quality",ylab="",main="Qualityscore distribution over all sequences")
table
plot(table$X.Quality,table$Count,type="l",col="red",xlab="Mean Sequence Quality",ylab="",main="Qualityscore distribution over all sequences")
legend("topright",legend="Average Quality per read",cex=.5,text.col="red")
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/pos_gc_content.tsv", sep="\t",header=TRUE,skip=1)
plot(table$X.Base,table$GC,type="l",col="red",xlab="Position in read (bp)",ylab="",main="GC content across all bases",ylim=c(0,100))
table
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/per_pos_qual.tsv", sep="\t",header=TRUE,skip=1)
x<-boxplot(table$Median~table$Base,plot=FALSE)
x$stats[2,]<-table$Lower.Quartile
x$stats[1,]<-table$X10th.Percentile
x$stats[3,]<-table$Median
x$stats[5,]<-table$X90th.Percentile
x$stats[4,]<-table$Upper.Quartile
x$names<-table$Base
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base)/2,ny=0,lty=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/seq_qual.tsv", sep="\t",header=TRUE,skip=1)
plot(table$X.Quality,table$Count,type="l",col="red",xlab="Mean Sequence Quality",ylab="",main="Qualityscore distribution over all sequences")
legend("topright",legend="Average Quality per read",text.col="red")
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/pos_gc_content.tsv", sep="\t",header=TRUE,skip=1)
plot(table$Base,table$GC,type="l",col="red",xlab="Position in read (bp)",ylab="",main="GC content across all bases",ylim=c(0,100))
legend("topright",legend="%GC",text.col="red")
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/pos_nuc_dist.tsv", sep="\t",header=TRUE,skip=1)
plot(table$Base,table$G,type="l",col="red",ylim=c(0,100),xlab="Mean Sequence Quality",ylab="",main="Sequence content accross all bases")
colnames(table)
plot(table$X.Base,table$G,type="l",col="red",ylim=c(0,100),xlab="Mean Sequence Quality",ylab="",main="Sequence content accross all bases")
lines(table$A,lwd=1,col="blue")
lines(table$T,lwd=1,col="green")
lines(table$C,lwd=1,col="black")
lines(table$N,lwd=1,col="orange")
legend("topright",legend=c("%G","%A","%T","%C","%N"),text.col=c("red","blue","green","black","orange"))
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/seq_gc_content.tsv", sep="\t",header=TRUE,skip=1)
plot(table$GC.Content,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences")
plot(table$X.GC.Content,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences")
colnames(table)
plot(table$X.GC,table$Count,type="l",col="red",xlab="Mean GC content (%)",ylab="",main="GC distribution over all sequences")
legend("topright",legend=c("GC count per read"),text.col=c("red"))
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/pos_n_content.tsv", sep="\t",header=TRUE,skip=1)
plot(table$Base,table$GC,type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,100))
table
plot(table$X.Base,table$X.GC,type="l",col="red",xlab="Position in read (bp)",ylab="",main="N content across all bases",ylim=c(0,100))
legend("topright",legend="%N",text.col="red")
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/readlength.tsv", sep="\t",header=TRUE,skip=1)
x <- c(min(table$X.Length)-1,table$X.Length,max(table$X.Length)+1)
y <- c(0,table$Count,0)
z <- seq(0,max(y),by=max(y)/10)
plot(x,y,xaxt="n",yaxt="n",type="l",col="red",xlab="Sequence length (bp)",ylab="",main="Distribution of sequences length over all sequences",panel.first = grid(nx=0,ny=5,lty="dotted"))
axis(2, at=z,labels=z, col.axis="black", las=1)
axis(1, at=x,labels=x, col.axis="black", las=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="orange")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","orange","magenta"),bg="gray95",horiz=TRUE)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/per_pos_qual.tsv", sep="\t",header=TRUE,skip=1)
x<-boxplot(table$Median~table$Base,plot=FALSE)
x$stats[2,]<-table$Lower.Quartile
x$stats[1,]<-table$X10th.Percentile
x$stats[3,]<-table$Median
x$stats[5,]<-table$X90th.Percentile
x$stats[4,]<-table$Upper.Quartile
x$names<-table$Base
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases")
rect(0,0,max(table$Base)+2,20,col="lightcoral",border="lightcoral")
rect(0,20,max(table$Base)+2,28,col="lightgoldenrod",border="lightgoldenrod")
rect(0,28,max(table$Base)+2,max(table$X90th.Percentile)+3,col="lightgreen",border="lightgreen")
bxp(x,medlwd=1,medcol="red",boxfill = "yellow", border =1, ylim=c(0,max(table$X90th.Percentile)),xlim=c(0,length(table$Median)),main="Qualityscore across all bases",add=TRUE)
lines(table$Mean,lwd=1,col="blue")
grid(nx=max(table$Base)/2,ny=0,lty=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/seq_qual.tsv", sep="\t",header=TRUE,skip=1)
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$X.Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
table
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmerContent.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$X.Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
table
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmer_content.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$X.Position,table[,2],lwd=3,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="orange")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
legendtext<-c(ltv[2],ltv[3],ltv[4],ltv[5],ltv[6],ltv[7])
legend("topright",legend=legendtext,text.col=c("red","blue","green","black","orange","magenta"),bg="gray95",horiz=TRUE)
table
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/kmer_content.tsv", sep="\t",header=TRUE,skip=1)
ylimvar<-c(table[,2],table[,3],table[,4],table[,5],table[,6],table[,7])
plot(table$X.Position,table[,2],lwd=2,type="l",col="red",xlab="Position in read (bp)",ylab="",main="Absolute enrichment over read length",ylim=c(0,max(ylimvar)))
lines(table[,3],lwd=3,col="blue")
lines(table[,4],lwd=3,col="green")
lines(table[,5],lwd=3,col="black")
lines(table[,6],lwd=3,col="orange")
lines(table[,7],lwd=3,col="magenta")
ltv<-colnames(table)
table
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/summary.tsv", sep="\t",header=TRUE,skip=1)
table
table[1,1]
table[2,1]
table[1,2]
table$Value[1]
x<-table$Value[1]
x
s<-t(table)
s
s[1,1]
s[1,2]
s[2,2]
s[2,1]
s[3,1]
s[2,2]
y<-t(table)
x<-c("<table>
<tr>
<th>Measure</th>
<th>Value</th>
</tr>
<tr>
<td>Filename</td>
<td>",y[2,1],"</td>
</tr>
<tr>
<td>File type</td>
<td>",y[2,2],"</td>
</tr>
<tr>
<td>Sequence length</td>
<td>",y[2,3],"</td>
</tr>
<tr>
<td>GC Content</td>
<td>",y[2,4],"</td>
</tr>
<tr>
<td>N Content</td>
<td>",y[2,5],"</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>",y[2,6],"</td>
</tr>
<tr>
<td>Score Range</td>
<td>",y[2,7],"</td>
</tr>
</table>")
x
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/summary.tsv", sep="\t",header=FALSE,skip=2)
y<-t(table)
x<-c("<table>
<tr>
<th>Measure</th>
<th>Value</th>
</tr>
<tr>
<td>Filename</td>
<td>",y[2,1],"</td>
</tr>
<tr>
<td>File type</td>
<td>",y[2,2],"</td>
</tr>
<tr>
<td>Sequence length</td>
<td>",y[2,3],"</td>
</tr>
<tr>
<td>GC Content</td>
<td>",y[2,4],"</td>
</tr>
<tr>
<td>N Content</td>
<td>",y[2,5],"</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>",y[2,6],"</td>
</tr>
<tr>
<td>Score Range</td>
<td>",y[2,7],"</td>
</tr>
</table>")
c
x
write(x,file="/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/summary.html")
table <- read.csv("/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/summary.tsv", sep="\t",header=FALSE,skip=2)
y<-t(table)
x<-c("<style type=","text/css",">
table {
margin-left: 3em;
text-align: center;
}
th {
text-align: center;
background-color: #000080;
color: #FFF;
padding: 0.4em;
}
td {
font-family: monospace;
text-align: left;
background-color: #EEE;
color: #000;
padding: 0.4em;
}
</style>
<table>
<tr>
<th>Measure</th>
<th>Value</th>
</tr>
<tr>
<td>Filename</td>
<td>",y[2,1],"</td>
</tr>
<tr>
<td>File type</td>
<td>",y[2,2],"</td>
</tr>
<tr>
<td>Sequence length</td>
<td>",y[2,3],"</td>
</tr>
<tr>
<td>GC Content</td>
<td>",y[2,4],"</td>
</tr>
<tr>
<td>N Content</td>
<td>",y[2,5],"</td>
</tr>
<tr>
<td>Total Sequences</td>
<td>",y[2,6],"</td>
</tr>
<tr>
<td>Score Range</td>
<td>",y[2,7],"</td>
</tr>
</table>")
write(x,file="/home/dkersting/Development/seqan-trunk/sandbox/group2/apps/seqc/expected/summary.html")
